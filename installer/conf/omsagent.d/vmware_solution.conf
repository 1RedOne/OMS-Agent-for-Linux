<source>
  type http
  port 1515
  bind 127.0.0.1
  format json
</source>

<source>
  type exec
  command 'powershell /opt/microsoft/omsagent/plugin/vmware_vm.ps1'
  format json
  run_interval 5m
  tag oms.api.VMwareSolution
</source>

<source>
  type exec
  command 'powershell /opt/microsoft/omsagent/plugin/vmware_host.ps1'
  format json
  run_interval 5m
  tag oms.api.VMwareSolution
</source>

<source>
  type exec
  command 'powershell /opt/microsoft/omsagent/plugin/vmware_perf_host.ps1'
  format json
  run_interval 5m
  tag oms.vmware_perf
</source>

<source>
  type exec
  command 'powershell /opt/microsoft/omsagent/plugin/vmware_perf_vm.ps1'
  format json
  run_interval 5m
  tag oms.vmware_perf
</source>

<match oms.api.VMwareSolution.**>
  type out_oms_api
  log_level info

  buffer_chunk_limit 1m
  buffer_type file
  buffer_path /var/opt/microsoft/omsagent/state/out_oms_api_vmwaresol_logs*.buffer
  buffer_queue_limit 2
  flush_interval 30s
  retry_limit 10
  retry_wait 30s
</match>