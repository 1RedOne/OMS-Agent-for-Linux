<source>
  type tail
  format /^(?<Timestamp>\d{1,2}\-\S{3,4}\-\d{4}::\d{1,2}:\d{1,2}:\d{1,2})(?<Message>.*)$/
  time_format %d-%m-%y::%H:%M:%S
  path /var/log/rabbitmq/startup_log
  pos_file /var/opt/microsoft/omsagent/state/out_oms_api_rabbitmq-startup.pos
  read_from_head true
  tag oms.api.Rabbitmq
</source>

<source>
  type tail
  format /^(?<Timestamp>\d{1,2}\-\S{3,4}\-\d{4}::\d{1,2}:\d{1,2}:\d{1,2})(?<Message>.*)$/
  time_format %d-%m-%y::%H:%M:%S
  path /var/log/rabbitmq/startup_err
  pos_file /var/opt/microsoft/omsagent/state/out_oms_api_rabbitmq-startup_err.pos
  read_from_head true
  tag oms.api.Rabbitmq
</source>

<source>
  type tail
  format multiline
  format_firstline /^=\w+ REPORT====/
  format1 /(?<message>.*)/
  path /var/log/rabbitmq/*-sasl.log
  pos_file /var/opt/microsoft/omsagent/state/out_oms_api_rabbitmq-sasl.pos
  read_from_head true
  tag oms.api.Rabbitmq
</source>

<source>
  type tail
  format multiline
  format_firstline /^=\w+ REPORT====/
  format1 /(?<message>.*)/
  path /var/log/rabbitmq/*.log
  pos_file /var/opt/microsoft/omsagent/state/out_oms_api_rabbitmq.pos
  read_from_head true
  tag oms.api.Rabbitmq
</source>

<filter oms.api.Rabbitmq>
  type record_transformer
  enable_ruby
  <record>
    Computer ${OMS::Common.get_hostname}
    Timestamp ${DateTime.parse(record["Timestamp"]).strftime("%FT%H:%M:%S.%3NZ")}
  </record>
</filter>