<source>
  type mongostat
  tag oms.mongo
  host localhost
  port 27017
  run_interval 10 
</source>

#for mongoDB version < 3.0
#<source>
# type tail
# path /var/log/mongodb/mongod.log
# tag  oms.api.MongoDBlog
# format /(?<timestamp>[^ ]*) \[(?<context>[^\]]*)\] (?<message>.*)/
#</source>

#for mongoDB version 3.0+
<source>
  type tail
  path /var/log/mongodb/mongod.log
  tag  oms.api.MongoDBlog
  format /(?<timestamp>[^ ]*) (?<severity>[A-Z]) (?<component>[^ ]*)  \[(?<context>[^\]]*)\] (?<message>.*)/
</source>

<match oms.api.**>
  type out_oms_api
  log_level info

  buffer_chunk_limit 5m
  buffer_type file
  buffer_path /var/opt/microsoft/omsagent/state/out_oms_mongo*.buffer
  buffer_queue_limit 10
  flush_interval 20s
  retry_limit 10
  retry_wait 30s
</match>

